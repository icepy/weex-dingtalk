{"version":3,"file":"weex-dingtalk.js","sources":["../node_modules/weex-dingtalk-exec/src/android_exec.js","../node_modules/weex-dingtalk-exec/src/ios_exec.js","../node_modules/weex-dingtalk-polyfills/src/core/env.js","../node_modules/weex-dingtalk-polyfills/src/core/requireModule.js","../node_modules/weex-dingtalk-polyfills/src/index.js","../node_modules/weex-dingtalk-exec/src/index.js","../node_modules/weex-dingtalk-require/src/global-api/system-modules.js","../node_modules/weex-dingtalk-require/src/global-api/EventEmitter.js","../node_modules/weex-dingtalk-require/src/global-api/parseModules.js","../node_modules/weex-dingtalk-require/src/index.js","../src/core/permissionJsApis.js","../src/core/parseJsApis.js","../src/platforms/web/nativeEvent.js","../src/platforms/web/apis.js","../src/platforms/web/index.js","../src/shared/logger.js","../src/index.js"],"sourcesContent":["/**\n * Created by xiangwenwen on 2017/3/24.\n */\n\n// @flow\n\nexport default function android_exec(exec:Function,config:Object){\n  const body = config.body;\n  const win = config.onSuccess;\n  const fail = config.onFail;\n  const context = config.context;\n  const STATUS_NO_RESULT: string = '0';\n  const STATUS_OK: string = '1';\n  const STATUS_ERROR: string = '2';\n  if (exec && typeof exec === 'function'){\n    exec(body,function (response) {\n      if (typeof response !== \"undefined\" && response.__status__) {\n        const status = response.__status__;\n        const message = response.__message__;\n        if (STATUS_OK === status){\n            win && win.call(context, message);\n        } else if (STATUS_ERROR === status){\n            fail && fail.call(context, message);\n        }\n      } else {\n        fail && fail.call('-1', \"\");\n      }\n    });\n  } else {\n    fail && fail.call('-1', \"\");\n  }\n}\n","/**\n * Created by xiangwenwen on 2017/3/24.\n */\n\n// @flow\n\nexport default function ios_exec(exec:Function,config:Object){\n  const body = config.body;\n  const win = config.onSuccess;\n  const fail = config.onFail;\n  const context = config.context;\n  if (exec && typeof exec === 'function'){\n    exec(body,function (response) {\n      if (typeof response !== \"undefined\") {\n        if ('0' === response.errorCode) {\n          win && win.call(context, response.result);\n        } else {\n          fail && fail.call(context, response.result);\n        }\n      }\n      else {\n          fail && fail.call('-1', \"\");\n      }\n    });\n  } else {\n    fail && fail.call('-1', \"\");\n  }\n}\n","/* @flow */\n\nfunction initEnv() : Object{\n  let weexEnv = {};\n  if (typeof weex !== 'undefined'){\n    weexEnv.platform = weex.config.env.platform;\n    if (weexEnv.platform !== 'Web'){\n      weexEnv.dingtalk = {\n        bundleUrl: weex.config.bundleUrl,\n        originalUrl: weex.config.originalUrl\n      };\n    }\n  } else {\n    // Rax Weex\n    if (typeof callNative === 'function'){\n      weexEnv.platform = navigator.platform;\n      weexEnv.dingtalk = {\n        bundleUrl: __weex_options__.bundleUrl,\n        originalUrl: __weex_options__.originalUrl\n      };\n    } else {\n      // Rax Web\n      weexEnv.platform = 'Web';\n    }\n  }\n  return weexEnv;\n}\n\nexport default initEnv;\n","/* @flow */\n\nfunction initRequireModule () : Function {\n  let requireModule = function(name){\n    let moduleName = '@weex-module/' + name;\n    return __weex_require__(moduleName);\n  }\n  if (typeof weex !== 'undefined'){\n    requireModule = weex.requireModule;\n  }\n  return requireModule;\n}\n\nexport default initRequireModule;\n","/* @flow */\n\nimport initEnv from './core/env.js';\nimport initRequire from './core/requireModule.js';\n\nfunction polyfills () : Object{\n  let weexVar = {\n    env: initEnv(),\n    requireModule: initRequire()\n  };\n  return weexVar;\n}\n\nlet weexInstanceVar;\nif (!weexInstanceVar){\n  weexInstanceVar = polyfills();\n}\n\nexport default weexInstanceVar;\n","/**\n * Created by xiangwenwen on 2017/3/24.\n */\n\n// @flow\n\nimport android_exec from './android_exec.js';\nimport ios_exec from './ios_exec.js';\nimport weexInstanceVar from 'weex-dingtalk-polyfills';\n\nlet platform  = weexInstanceVar.env.platform;\nlet nativeExec: ?Function = null;\nif (platform !== 'Web'){\n  nativeExec = weexInstanceVar.requireModule('nuvajs-exec').exec;\n}\n\nfunction exec_affirm(plugin: string, action: string, args: ?Object,onSuccess: ?Function, onFail: ?Function, context: ?Object){\n  const body: {\n    plugin: string,\n    action: string,\n    args: Object\n  } = {\n    plugin: plugin,\n    action: action,\n    args: args ? args : {}\n  }\n  const config: {\n    body: Object,\n    onSuccess: ?Function,\n    onFail: ?Function,\n    context: ?Object\n  } = {\n    body: body,\n    onSuccess: onSuccess ? onSuccess : null,\n    onFail: onFail ? onFail : null,\n    context: context ? context : null\n  }\n  exec(config);\n}\n\nfunction exec(config:Object) {\n  let native_exec: Function = nativeExec ? nativeExec : function(){};\n  if (platform === 'iOS'){\n      ios_exec(native_exec,config);\n  } else {\n      if (platform === 'android'){\n          android_exec(native_exec,config);\n      }\n  }\n}\n\nexport default exec;\n","/**\n * Created by xiangwenwen on 2017/3/24.\n */\n\n// @flow\n\nlet __nuva_modules__: Object = {};\nlet requireStack: Array<string> = [];\nlet inProgressModules: Object = {};\n\nfunction build(__nuva_module__: Object) {\n  let factory = __nuva_module__.factory;\n  __nuva_module__.__nuva_exports__ = {};\n  delete __nuva_module__.factory;\n  factory(__nuva_require__, __nuva_module__.__nuva_exports__, __nuva_module__);\n  return __nuva_module__.__nuva_exports__;\n}\nexport function __nuva_require__(id: string) : any {\n  if (!__nuva_modules__[id]) {\n    throw '__nuva_module__ ' + id + ' not found';\n  } else if (id in inProgressModules) {\n    const cycle = requireStack.slice(inProgressModules[id]).join('->') + '->' + id;\n    throw 'Cycle in require graph: ' + cycle;\n  }\n  if (__nuva_modules__[id].factory) {\n    try {\n      inProgressModules[id] = requireStack.length;\n      requireStack.push(id);\n      return build(__nuva_modules__[id]);\n    } finally {\n      delete inProgressModules[id];\n      requireStack.pop();\n    }\n  }\n  return __nuva_modules__[id].__nuva_exports__;\n};\n\nexport function __nuva_define__(id: string, factory: Function) {\n  if (__nuva_modules__[id]) {\n    throw 'module ' + id + ' already defined';\n  }\n  __nuva_modules__[id] = {\n    id: id,\n    factory: factory\n  };\n};\n\nexport function __nuva_define_remove__(id: string){\n  delete __nuva_modules__[id];\n}\n","/**\n * Created by xiangwenwen on 2017/3/24.\n */\n\n// @flow\n\nlet cat: Object = {};\nlet EventEmitter:{\n  on: Function,\n  off: Function,\n  once: Function,\n  emit: Function\n} = {\n  on: function(event: string,fun: Function){\n    let cbs = cat[event];\n    cbs ? cbs.push(fun) : cat[event] = [];\n    if (!cbs) {\n      cat[event].push(fun);\n    }\n  },\n  off: function(event: string,fun: Function){\n    let cbs = cat[event];\n    if (!cbs) {\n      return false;\n    }\n    if (!event && !fun) {\n      cat = {};\n      return true;\n    }\n    if (event && !fun) {\n      cat[event] = null;\n      return true;\n    }\n    let cb;\n    let i = cbs.length;\n    while(i--){\n      cb = cbs[i];\n      if (cb === fun || cb.fun === fun) {\n        cbs.splice(i,1);\n        break;\n      }\n    }\n    return true;\n  },\n  once: function(event: string,fun: Function){\n    function _on(){\n      EventEmitter.off(event,_on);\n      fun.apply(this,arguments);\n    }\n    _on.fun = fun;\n    EventEmitter.on(event,_on);\n  },\n  emit: function(event: string){\n    let isString = typeof event === 'string';\n    if (!isString){\n      return;\n    }\n    let cbs = cat[event];\n    let args = toArray(arguments,1);\n    if (cbs) {\n      let i = 0;\n      let j = cbs.length;\n      for(;i<j;i++){\n        let cb = cbs[i];\n        cb.apply(this,args);\n      }\n    }\n  }\n};\n\nfunction toArray(list: Array<any>, index: ?number) {\n  let _index = index || 0;\n  let i = list.length - _index;\n  let _array = new Array(i);\n  while(i--){\n    _array[i] = list[i + _index]\n  }\n  return _array\n}\n\nexport default EventEmitter;\n","/**\n * Created by xiangwenwen on 2017/3/24.\n */\n\n// @flow\n\nimport exec from 'weex-dingtalk-exec';\nimport { __nuva_define__ } from './system-modules.js';\n\nexport default function parseModules(map: Object){\n  for (let name in map) {\n    let methods = map[name];\n    (function(_name, _methods) {\n      __nuva_define__(_name, function(__nuva_require__, __nuva_exports__,__nuva_module__) {\n        let p = {};\n        p._name = _name;\n        for (let i in _methods) {\n          let action = _methods[i];\n          p[action] = (function(_action) {\n            return function(params) {\n              if (!params) {\n                params = {};\n              }\n              let onSuccess = params.onSuccess;\n              let onFail = params.onFail;\n              delete params.onSuccess;\n              delete params.onFail;\n              delete params.onCancel;\n              const config = {\n                body: {\n                  plugin: _name,\n                  action: _action,\n                  args: params\n                },\n                onSuccess: onSuccess,\n                onFail: onFail\n              };\n              return exec(config);\n            };\n          })(action);\n        };\n        __nuva_module__.__nuva_exports__ = p;\n      });\n    })(name, methods);\n  }\n}\n","/**\n * Created by xiangwenwen on 2017/3/24.\n */\n\n// @flow\n\nimport exec from 'weex-dingtalk-exec';\nimport { __nuva_require__, __nuva_define__, __nuva_define_remove__ } from './global-api/system-modules.js';\nimport EventEmitter from './global-api/EventEmitter.js';\nimport parseModules from './global-api/parseModules.js';\nimport weexInstanceVar from 'weex-dingtalk-polyfills';\n\nlet platform = weexInstanceVar.env.platform;\nlet globalEvent: Object = {};\nif (platform !== 'Web'){\n  globalEvent = weexInstanceVar.requireModule('globalEvent');\n}\n\nfunction rtFunc(method: string): Function {\n  return function(cb: Function) {\n    const config:{\n      body: Object,\n      onSuccess: Function,\n      onFail: Function,\n      context: ?Object\n    } = {\n      body: {\n        plugin: 'runtime',\n        action: method,\n        args: {}\n      },\n      onSuccess: function(response){\n        if (typeof cb === 'function'){\n          cb(response);\n        }\n      },\n      onFail: function(){\n\n      },\n      context: null\n    };\n    exec(config);\n  };\n}\n\nfunction initDingtalkRequire(cb: Function){\n    rtFunc('getModules')(cb);\n}\n\nlet nuva: {\n  getModules: ?Object,\n  isReady: boolean,\n  define: Function,\n  require: Function,\n  runtime: Object,\n  init: Function,\n  ready: Function,\n  on: Function,\n  off: Function,\n  EventEmitter: Object\n} = {\n  getModules: null,\n  isReady: false,\n  define: __nuva_define__,\n  require: function(id: string) : any{\n    if (!id){\n      return exec;\n    } else {\n      return __nuva_require__(id);\n    }\n  },\n  runtime: {\n    info: rtFunc('info'),\n    _interceptBackButton: rtFunc('interceptBackButton'),\n    _interceptNavTitle: rtFunc('interceptNavTitle'),\n    _recoverNavTitle: rtFunc('recoverNavTitle'),\n    _getModules: rtFunc('getModules')\n  },\n  init: function(){\n    initDingtalkRequire(function(response){\n      if(response){\n        parseModules(response);\n        nuva.isReady = true;\n        nuva.getModules = response;\n        EventEmitter.emit('__nuva_ready__');\n      }\n    });\n  },\n  ready: function(cb: Function){\n    if (nuva.isReady){\n      if (typeof cb === 'function'){\n        cb();\n      }\n    } else {\n      if (typeof cb === 'function'){\n        EventEmitter.once('__nuva_ready__', function(){\n          cb();\n        });\n      }\n    }\n  },\n  on: function(type: string, handler: Function){\n    globalEvent.addEventListener(type,function(e){\n      const event:{\n        preventDefault: Function,\n        detail: Object\n      } = {\n        preventDefault: function () {\n          console.warn('当前环境不支持 preventDefault')\n        },\n        detail: e\n      };\n      handler.call(this,event);\n    });\n  },\n  off: globalEvent.removeEventListener,\n  EventEmitter: EventEmitter\n};\n\nexport default nuva;\n","/**\n * Created by xiangwenwen on 2017/3/27.\n */\n\n//@flow\n\nimport dt_nuva from 'weex-dingtalk-require';\n\nconst runtimePermission: string = 'runtime.permission';\n\nexport default function permissionJsApis(cb: Function,jsApisConfig:?Object, errorCb: ?Function){\n  if (!jsApisConfig){\n    cb(null);\n    return;\n  }\n  dt_nuva.ready(function(){\n    const permission = dt_nuva.require(runtimePermission);\n    let apisConf = jsApisConfig ? jsApisConfig : {};\n    let errCb = errorCb ? errorCb : null;\n    apisConf.onSuccess = function(response){\n      cb(null, response);\n    };\n    apisConf.onFail = function(error){\n      if (typeof errCb === 'function'){\n        errCb(error);\n      } else {\n        cb(error, null);\n      }\n    };\n    permission.requestJsApis(apisConf);\n  });\n}\n","/**\n * Created by xiangwenwen on 2017/3/27.\n */\n\n//@flow\n\nimport dt_nuva from 'weex-dingtalk-require';\n\nexport default function parseJsApis(jsApis: Object) : Object{\n  let apis: Object = {};\n  for (let name: string in jsApis) {\n    let node: Array<string> = name.split('.');\n    let staging = null;\n    let i: number = 0;\n    let j: number = node.length;\n    while (true) {\n      if (!staging) {\n        if (1 === j) {\n          apis[node[i]] = dt_nuva.require(name);\n          break;\n        }\n        if (apis[node[i]]){\n          staging = apis[node[i]];\n          i++;\n          continue;\n        }\n        apis[node[i]] = {};\n        staging = apis[node[i]];\n        i++;\n        continue;\n      } else {\n        if ((j - 1) === i) {\n          staging[node[i]] = dt_nuva.require(name);\n          break;\n        }\n        if (staging[node[i]]) {\n          i++;\n          continue;\n        }\n        staging[node[i]] = {};\n        staging = staging[node[i]];\n      }\n      i++;\n    }\n  }\n\treturn apis;\n}\n","\n/* @flow */\n\nfunction initNativeEvent(dt:Object){\n  dt.on = function(type, listener, useCapture){\n    document.addEventListener(type, listener, useCapture);\n  }\n  dt.off = function(type, listener, useCapture){\n    document.removeEventListener(type, listener, useCapture);\n  }\n}\n\nexport default initNativeEvent;\n","\n/* @flow */\n\nfunction initApis(dt: Object){\n  dt.apis = dt;\n}\n\nexport default initApis;\n","\n/* @flow */\n\nimport initNativeEvent from './nativeEvent.js';\nimport initApis from './apis.js';\n\nfunction initWebDingtalkSDK () : Object {\n  const GLOBALWINDOW:GLOBALWINDOW = (function(){\n    return (function(){\n      return window || this;\n    })();\n  })();\n  if (!GLOBALWINDOW.dd){\n    console.error('Not Found Dingtalk.js');\n    throw new Error()\n  }\n  initNativeEvent(GLOBALWINDOW.dd);\n  initApis(GLOBALWINDOW.dd);\n  return GLOBALWINDOW.dd;\n}\n\nexport default initWebDingtalkSDK;\n","/* @flow */\n\nconst logger:{\n  warn:Function,\n  info:Function,\n  error:Function\n} = {\n  warn: function (msg: string, e:Object){\n    console.warn('[DINGTALK JS SDK Warning]:', msg);\n    if (e) {\n      throw e;\n    } else {\n      const warning = new Error('WARNING STACK TRACE');\n      console.warn(warning.stack);\n    }\n  },\n  info: function (msg){\n    console.info('[DINGTALK JS SDK INFO]:', msg);\n  },\n  error: function (msg){\n    console.error('[DINGTALK JS SDK ERROR]:', msg);\n  }\n};\n\nexport default logger;\n","/**\n * Created by xiangwenwen on 2017/3/27.\n */\n\n// @flow\n\nimport dt_nuva from 'weex-dingtalk-require';\nimport weexInstanceVar from 'weex-dingtalk-polyfills';\nimport permissionJsApis from './core/permissionJsApis.js';\nimport { extend } from './shared/util.js';\nimport parseJsApis from './core/parseJsApis.js';\nimport initWebDingtalkSDK from './platforms/web/index.js';\nimport logger from './shared/logger.js';\n\nlet dingtalkJsApisConfig: ?Object = null;\nlet dingtalkQueue: ?Array<Function> = null;\nlet dingtalkErrorCb: ?Function = null;\nlet dingtalkInit: boolean = true;\nlet platform = weexInstanceVar.env.platform;\n\nfunction performQueue (){\n  if (dingtalkQueue && dingtalkQueue.length > 0){\n    dingtalkQueue.forEach(function(task){\n      task();\n    });\n    dingtalkQueue.length = 0;\n  }\n}\n\nlet dingtalkSDK: Object = {};\nlet dingtalk: {\n  isSync: boolean,\n  apis: Object,\n  config: Function,\n  init: Function,\n  ready: Function,\n  on: Function,\n  off: Function,\n  error: Function\n} = {\n  isSync: false,\n  apis: {},\n  config: function(config: Object){\n    if (!config){\n      logger.warn('config is undefined,you must configure Dingtalk parameters');\n      return;\n    }\n    dingtalkJsApisConfig = config;\n  },\n  init: function(){\n    // 初始化一次\n    dingtalkQueue = [];\n    dt_nuva.init();\n    dt_nuva.ready(function(){\n      dingtalk.isSync = true;\n      dingtalk.apis = parseJsApis(dt_nuva.getModules ? dt_nuva.getModules : {});\n      performQueue();\n    });\n  },\n  ready: function(cb: Function){\n    if (!cb || typeof cb !== 'function'){\n      logger.warn('callback is undefined');\n      return;\n    }\n    if (dingtalk.isSync){\n      permissionJsApis(cb,dingtalkJsApisConfig,dingtalkErrorCb);\n    } else {\n      function bufferFunction(cb){\n        return function(){\n          permissionJsApis(cb,dingtalkJsApisConfig,dingtalkErrorCb);\n        }\n      }\n      dingtalkQueue && dingtalkQueue.push(bufferFunction(cb));\n    }\n  },\n  error: function(cb){\n    if (typeof cb === 'function'){\n      dingtalkErrorCb = cb;\n    }\n  },\n  on: dt_nuva.on,\n  off: dt_nuva.off\n};\n\nif (dingtalkInit){\n  dingtalkInit = false;\n  switch (platform){\n    case 'Web':\n        dingtalkSDK = initWebDingtalkSDK();\n      break;\n    default:\n        dingtalkSDK = dingtalk;\n        dingtalk.init();\n      break\n  }\n}\n\nexport default dingtalkSDK;\n"],"names":["android_exec","exec","config","body","win","onSuccess","fail","onFail","context","STATUS_NO_RESULT","STATUS_OK","STATUS_ERROR","response","__status__","status","message","__message__","call","ios_exec","errorCode","result","initEnv","weexEnv","weex","platform","env","dingtalk","bundleUrl","originalUrl","callNative","navigator","__weex_options__","initRequireModule","requireModule","name","moduleName","__weex_require__","polyfills","weexVar","initRequire","weexInstanceVar","nativeExec","native_exec","__nuva_modules__","requireStack","inProgressModules","build","__nuva_module__","factory","__nuva_exports__","__nuva_require__","id","cycle","slice","join","length","push","pop","__nuva_define__","cat","EventEmitter","event","fun","cbs","cb","i","splice","_on","off","apply","arguments","on","isString","args","toArray","j","list","index","_index","_array","Array","parseModules","map","methods","_name","_methods","p","action","_action","params","onCancel","globalEvent","rtFunc","method","initDingtalkRequire","nuva","isReady","getModules","emit","once","type","handler","addEventListener","e","warn","removeEventListener","runtimePermission","permissionJsApis","jsApisConfig","errorCb","ready","permission","dt_nuva","require","apisConf","errCb","error","requestJsApis","parseJsApis","jsApis","apis","node","split","staging","initNativeEvent","dt","listener","useCapture","initApis","initWebDingtalkSDK","GLOBALWINDOW","window","dd","Error","logger","msg","warning","stack","info","dingtalkJsApisConfig","dingtalkQueue","dingtalkErrorCb","dingtalkInit","performQueue","forEach","task","dingtalkSDK","init","isSync","bufferFunction"],"mappings":"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"}